<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>luau: gcontainer.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a></div>
<h1>gcontainer.c</h1><a href="gcontainer_8c.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*</span>
00002 <span class="comment"> * luau (Lib Update/Auto-Update): Simple Update Library</span>
00003 <span class="comment"> * Copyright (C) 2003  David Eklund</span>
00004 <span class="comment"> *</span>
00005 <span class="comment"> * - This library is free software; you can redistribute it and/or             -</span>
00006 <span class="comment"> * - modify it under the terms of the GNU Lesser General Public                -</span>
00007 <span class="comment"> * - License as published by the Free Software Foundation; either              -</span>
00008 <span class="comment"> * - version 2.1 of the License, or (at your option) any later version.        -</span>
00009 <span class="comment"> * -                                                                           -</span>
00010 <span class="comment"> * - This library is distributed in the hope that it will be useful,           -</span>
00011 <span class="comment"> * - but WITHOUT ANY WARRANTY; without even the implied warranty of            -</span>
00012 <span class="comment"> * - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU         -</span>
00013 <span class="comment"> * - Lesser General Public License for more details.                           -</span>
00014 <span class="comment"> * -                                                                           -</span>
00015 <span class="comment"> * - You should have received a copy of the GNU Lesser General Public          -</span>
00016 <span class="comment"> * - License along with this library; if not, write to the Free Software       -</span>
00017 <span class="comment"> * - Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA -</span>
00018 <span class="comment"> */</span>
00019 
00020 <span class="preprocessor">#ifdef HAVE_CONFIG_H</span>
00021 <span class="preprocessor"></span><span class="preprocessor">#  include &lt;config.h&gt;</span>
00022 <span class="preprocessor">#endif</span>
00023 <span class="preprocessor"></span>
00024 <span class="preprocessor">#include &lt;glib.h&gt;</span>
00025 
00026 <span class="preprocessor">#include "<a class="code" href="gcontainer_8h.html">gcontainer.h</a>"</span>
00027 <span class="preprocessor">#include "<a class="code" href="error_8h.html">error.h</a>"</span>
00028 <span class="preprocessor">#include "<a class="code" href="util_8h.html">util.h</a>"</span>
00029 
00030 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="gcontainer_8c.html#a0">iterNext</a>(<a class="code" href="structGIterator.html">GIterator</a> *iter);
00031 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="gcontainer_8c.html#a1">iterPrev</a>(<a class="code" href="structGIterator.html">GIterator</a> *iter);
00032 
00033 <a class="code" href="structGContainer.html">GContainer</a> *
<a name="l00034"></a><a class="code" href="gcontainer_8h.html#a3">00034</a> <a class="code" href="gcontainer_8h.html#a3">g_container_new</a>(GContType type) {
00035         <a class="code" href="structGContainer.html">GContainer</a> *container;
00036         
00037         container = g_malloc(<span class="keyword">sizeof</span>(<a class="code" href="structGContainer.html">GContainer</a>));
00038         container-&gt;<a class="code" href="structGContainer.html#o0">type</a> = type;
00039         container-&gt;<a class="code" href="structGContainer.html#o1">len</a> = 0;
00040         
00041         <span class="keywordflow">if</span> (type == <a class="code" href="gcontainer_8h.html#a25a0">GCONT_PTR_ARRAY</a>)
00042                 container-&gt;<a class="code" href="structGContainer.html#o2">data</a> = g_ptr_array_new();
00043         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <a class="code" href="gcontainer_8h.html#a25a1">GCONT_LIST</a> || type == <a class="code" href="gcontainer_8h.html#a25a2">GCONT_SLIST</a>)
00044                 container-&gt;<a class="code" href="structGContainer.html#o2">data</a> = NULL;
00045         <span class="keywordflow">else</span> {
00046                 <a class="code" href="error_8h.html#a1">ERROR</a>(<span class="stringliteral">"Internal Error: Unrecognized type (%d)"</span>, container-&gt;<a class="code" href="structGContainer.html#o0">type</a>);
00047                 g_free(container);
00048                 container = NULL;
00049         }
00050         
00051         <span class="keywordflow">return</span> container;
00052 }
00053 
00054 <a class="code" href="structGContainer.html">GContainer</a> *
<a name="l00055"></a><a class="code" href="gcontainer_8h.html#a4">00055</a> <a class="code" href="gcontainer_8h.html#a4">g_container_new_from_data</a>(GContType type, <span class="keywordtype">void</span> *data) {
00056         <a class="code" href="structGContainer.html">GContainer</a> *container;
00057         
00058         <span class="keywordflow">if</span> (data == NULL)
00059                 <span class="keywordflow">return</span> NULL;
00060         
00061         container = g_malloc(<span class="keyword">sizeof</span>(<a class="code" href="structGContainer.html">GContainer</a>));
00062         container-&gt;<a class="code" href="structGContainer.html#o0">type</a> = type;
00063         container-&gt;<a class="code" href="structGContainer.html#o2">data</a> = data;
00064 
00065         <span class="keywordflow">if</span> (type == <a class="code" href="gcontainer_8h.html#a25a0">GCONT_PTR_ARRAY</a>)
00066                 container-&gt;<a class="code" href="structGContainer.html#o1">len</a> = ((GPtrArray*)data)-&gt;len;
00067         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <a class="code" href="gcontainer_8h.html#a25a1">GCONT_LIST</a>)
00068                 container-&gt;<a class="code" href="structGContainer.html#o1">len</a> = g_list_length(data);
00069         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == <a class="code" href="gcontainer_8h.html#a25a2">GCONT_SLIST</a>)
00070                 container-&gt;<a class="code" href="structGContainer.html#o1">len</a> = g_slist_length(data);
00071         <span class="keywordflow">else</span> {
00072                 <a class="code" href="error_8h.html#a1">ERROR</a>(<span class="stringliteral">"Internal Error: Unrecognized type (%d)"</span>, type);
00073                 container-&gt;<a class="code" href="structGContainer.html#o1">len</a> = 0;
00074         }
00075         
00076         <span class="keywordflow">return</span> container;
00077 }
00078 
00079 <a class="code" href="structGContainer.html">GContainer</a> *
<a name="l00080"></a><a class="code" href="gcontainer_8h.html#a5">00080</a> <a class="code" href="gcontainer_8h.html#a5">g_container_dup</a>(<span class="keyword">const</span> <a class="code" href="structGContainer.html">GContainer</a> *container)
00081 {
00082         <a class="code" href="structGContainer.html">GContainer</a> *results = <a class="code" href="gcontainer_8h.html#a3">g_container_new</a>(container-&gt;<a class="code" href="structGContainer.html#o0">type</a>);
00083         <a class="code" href="gcontainer_8h.html#a21">g_container_copy</a>(results, container);
00084         <span class="keywordflow">return</span> results;
00085 }
00086 
00087 <span class="keywordtype">void</span>
<a name="l00088"></a><a class="code" href="gcontainer_8h.html#a6">00088</a> <a class="code" href="gcontainer_8h.html#a6">g_container_add</a>(<a class="code" href="structGContainer.html">GContainer</a> *container, <span class="keyword">const</span> gpointer data) {
00089         container-&gt;<a class="code" href="structGContainer.html#o1">len</a>++;
00090         
00091         <span class="keywordflow">if</span> (container-&gt;<a class="code" href="structGContainer.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a0">GCONT_PTR_ARRAY</a>)
00092                 g_ptr_array_add(container-&gt;<a class="code" href="structGContainer.html#o2">data</a>, data);
00093         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (container-&gt;<a class="code" href="structGContainer.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a1">GCONT_LIST</a>)
00094                 container-&gt;<a class="code" href="structGContainer.html#o2">data</a> = g_list_append(container-&gt;<a class="code" href="structGContainer.html#o2">data</a>, data);
00095         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (container-&gt;<a class="code" href="structGContainer.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a2">GCONT_SLIST</a>)
00096                 container-&gt;<a class="code" href="structGContainer.html#o2">data</a> = g_slist_append(container-&gt;<a class="code" href="structGContainer.html#o2">data</a>, data);
00097         <span class="keywordflow">else</span>
00098                 <a class="code" href="error_8h.html#a1">ERROR</a>(<span class="stringliteral">"Internal Error: Unrecognized type (%d)"</span>, container-&gt;<a class="code" href="structGContainer.html#o0">type</a>);
00099 }
00100 
00101 <span class="keywordtype">void</span>
<a name="l00102"></a><a class="code" href="gcontainer_8h.html#a7">00102</a> <a class="code" href="gcontainer_8h.html#a7">g_container_concat</a>(<a class="code" href="structGContainer.html">GContainer</a> *container, <span class="keyword">const</span> <a class="code" href="structGContainer.html">GContainer</a> *new_items)
00103 {
00104         <a class="code" href="structGIterator.html">GIterator</a> iter;
00105         gboolean result;
00106         
00107         result = <a class="code" href="gcontainer_8h.html#a13">g_container_get_iter</a>(&amp;iter, new_items);
00108         <span class="keywordflow">if</span> (!result)
00109                 <span class="keywordflow">return</span>;
00110         
00111         <span class="keywordflow">while</span> (<a class="code" href="gcontainer_8h.html#a18">g_iterator_hasNext</a>(&amp;iter))
00112                 <a class="code" href="gcontainer_8h.html#a6">g_container_add</a>(container, <a class="code" href="gcontainer_8h.html#a16">g_iterator_next</a>(&amp;iter));
00113 }
00114         
00115 
00116 
00117 gboolean
<a name="l00118"></a><a class="code" href="gcontainer_8h.html#a8">00118</a> <a class="code" href="gcontainer_8h.html#a8">g_container_remove</a>(<a class="code" href="structGContainer.html">GContainer</a> *container, <span class="keyword">const</span> gpointer data) {
00119         gboolean result;
00120         <span class="keywordtype">int</span> newlen;
00121         
00122         <span class="comment">/* Unfortunately here we have to recompute the size after each remove operation for</span>
00123 <span class="comment">           list and slist types because glib doesn't let us know if the operation was successful</span>
00124 <span class="comment">           or not */</span>
00125         <span class="keywordflow">if</span> (container-&gt;<a class="code" href="structGContainer.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a0">GCONT_PTR_ARRAY</a>) {
00126                 result = g_ptr_array_remove(container-&gt;<a class="code" href="structGContainer.html#o2">data</a>, data);
00127                 <span class="keywordflow">if</span> (result) container-&gt;<a class="code" href="structGContainer.html#o1">len</a>--;
00128         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (container-&gt;<a class="code" href="structGContainer.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a1">GCONT_LIST</a>) {
00129                 container-&gt;<a class="code" href="structGContainer.html#o2">data</a> = g_list_remove(container-&gt;<a class="code" href="structGContainer.html#o2">data</a>, data);
00130                 newlen = g_list_length(container-&gt;<a class="code" href="structGContainer.html#o2">data</a>);
00131                 result = (newlen != container-&gt;<a class="code" href="structGContainer.html#o1">len</a>);
00132                 container-&gt;<a class="code" href="structGContainer.html#o1">len</a> = newlen;
00133         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (container-&gt;<a class="code" href="structGContainer.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a2">GCONT_SLIST</a>) {
00134                 container-&gt;<a class="code" href="structGContainer.html#o2">data</a> = g_slist_remove(container-&gt;<a class="code" href="structGContainer.html#o2">data</a>, data);
00135                 newlen = g_slist_length(container-&gt;<a class="code" href="structGContainer.html#o2">data</a>);
00136                 result = (newlen != container-&gt;<a class="code" href="structGContainer.html#o1">len</a>);
00137                 container-&gt;<a class="code" href="structGContainer.html#o1">len</a> = newlen;
00138         } <span class="keywordflow">else</span> {
00139                 <a class="code" href="error_8h.html#a1">ERROR</a>(<span class="stringliteral">"Internal Error: Unrecognized type (%d)"</span>, container-&gt;<a class="code" href="structGContainer.html#o0">type</a>);
00140                 result = FALSE;
00141         }
00142         
00143         <span class="keywordflow">return</span> result;
00144 }
00145 
00146 gboolean
<a name="l00147"></a><a class="code" href="gcontainer_8h.html#a9">00147</a> <a class="code" href="gcontainer_8h.html#a9">g_container_remove_fast</a>(<a class="code" href="structGContainer.html">GContainer</a> *container, <span class="keyword">const</span> gpointer data) {
00148         gboolean result;
00149         
00150         <span class="keywordflow">if</span> (container-&gt;<a class="code" href="structGContainer.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a0">GCONT_PTR_ARRAY</a>) {
00151                 result = g_ptr_array_remove_fast(container-&gt;<a class="code" href="structGContainer.html#o2">data</a>, data);
00152                 <span class="keywordflow">if</span> (result) container-&gt;<a class="code" href="structGContainer.html#o1">len</a>--;
00153         } <span class="keywordflow">else</span> {
00154                 result = <a class="code" href="gcontainer_8h.html#a8">g_container_remove</a>(container, data);
00155         }
00156         
00157         <span class="keywordflow">return</span> result;
00158 }
00159 
00160 gpointer
<a name="l00161"></a><a class="code" href="gcontainer_8h.html#a10">00161</a> <a class="code" href="gcontainer_8h.html#a10">g_container_remove_index</a>(<a class="code" href="structGContainer.html">GContainer</a> *container, guint index) {
00162         gpointer data;
00163         
00164         <span class="keywordflow">if</span> (index &gt;= container-&gt;<a class="code" href="structGContainer.html#o1">len</a>) {
00165                 <a class="code" href="error_8h.html#a1">ERROR</a>(<span class="stringliteral">"Index out of bounds"</span>);
00166                 <span class="keywordflow">return</span> NULL;
00167         }
00168         
00169         container-&gt;<a class="code" href="structGContainer.html#o1">len</a>--;
00170         
00171         <span class="keywordflow">if</span> (container-&gt;<a class="code" href="structGContainer.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a0">GCONT_PTR_ARRAY</a>)
00172                 data = g_ptr_array_remove_index(container-&gt;<a class="code" href="structGContainer.html#o2">data</a>, index);
00173         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (container-&gt;<a class="code" href="structGContainer.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a1">GCONT_LIST</a>) {
00174                 data = g_list_nth_data(container-&gt;<a class="code" href="structGContainer.html#o2">data</a>, index);
00175                 container-&gt;<a class="code" href="structGContainer.html#o2">data</a> = g_list_remove(container-&gt;<a class="code" href="structGContainer.html#o2">data</a>, data);
00176         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (container-&gt;<a class="code" href="structGContainer.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a2">GCONT_SLIST</a>) {
00177                 data = g_slist_nth_data(container-&gt;<a class="code" href="structGContainer.html#o2">data</a>, index);
00178                 container-&gt;<a class="code" href="structGContainer.html#o2">data</a> = g_slist_remove(container-&gt;<a class="code" href="structGContainer.html#o2">data</a>, data);
00179         } <span class="keywordflow">else</span> {
00180                 <a class="code" href="error_8h.html#a1">ERROR</a>(<span class="stringliteral">"Internal Error: Unrecognized type (%d)"</span>, container-&gt;<a class="code" href="structGContainer.html#o0">type</a>);
00181                 data = NULL;
00182         }
00183         
00184         <span class="keywordflow">return</span> data;
00185 }
00186 
00187 gpointer
<a name="l00188"></a><a class="code" href="gcontainer_8h.html#a11">00188</a> <a class="code" href="gcontainer_8h.html#a11">g_container_remove_index_fast</a>(<a class="code" href="structGContainer.html">GContainer</a> *container, guint index) {
00189         <span class="keywordflow">if</span> (index &gt;= container-&gt;<a class="code" href="structGContainer.html#o1">len</a>) {
00190                 <a class="code" href="error_8h.html#a1">ERROR</a>(<span class="stringliteral">"Index out of bounds"</span>);
00191                 <span class="keywordflow">return</span> NULL;
00192         }
00193         
00194         <span class="keywordflow">if</span> (container-&gt;<a class="code" href="structGContainer.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a0">GCONT_PTR_ARRAY</a>) {
00195                 container-&gt;<a class="code" href="structGContainer.html#o1">len</a>--;
00196                 <span class="keywordflow">return</span> g_ptr_array_remove_index_fast(container-&gt;<a class="code" href="structGContainer.html#o2">data</a>, index);
00197         } <span class="keywordflow">else</span>
00198                 <span class="keywordflow">return</span> <a class="code" href="gcontainer_8h.html#a10">g_container_remove_index</a>(container, index);
00199 }
00200 
00201 gpointer
<a name="l00202"></a><a class="code" href="gcontainer_8h.html#a12">00202</a> <a class="code" href="gcontainer_8h.html#a12">g_container_index</a>(<span class="keyword">const</span> <a class="code" href="structGContainer.html">GContainer</a> *container, guint index) {
00203         <span class="keywordflow">if</span> (index &gt;= container-&gt;<a class="code" href="structGContainer.html#o1">len</a>) {
00204                 <a class="code" href="error_8h.html#a1">ERROR</a>(<span class="stringliteral">"Index out of bounds"</span>);
00205                 <span class="keywordflow">return</span> NULL;
00206         }
00207         
00208         <span class="keywordflow">if</span> (container-&gt;<a class="code" href="structGContainer.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a0">GCONT_PTR_ARRAY</a>)
00209                 <span class="keywordflow">return</span> g_ptr_array_index(((GPtrArray*)container-&gt;<a class="code" href="structGContainer.html#o2">data</a>), index);
00210         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (container-&gt;<a class="code" href="structGContainer.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a1">GCONT_LIST</a>)
00211                 <span class="keywordflow">return</span> g_list_nth_data(container-&gt;<a class="code" href="structGContainer.html#o2">data</a>, index);
00212         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (container-&gt;<a class="code" href="structGContainer.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a2">GCONT_SLIST</a>)
00213                 <span class="keywordflow">return</span> g_slist_nth_data(container-&gt;<a class="code" href="structGContainer.html#o2">data</a>, index);
00214         <span class="keywordflow">else</span> {
00215                 <a class="code" href="error_8h.html#a1">ERROR</a>(<span class="stringliteral">"Internal Error: Unrecognized type (%d)"</span>, container-&gt;<a class="code" href="structGContainer.html#o0">type</a>);
00216                 <span class="keywordflow">return</span> NULL;
00217         }
00218 }
00219 
00220 gboolean
<a name="l00221"></a><a class="code" href="gcontainer_8h.html#a13">00221</a> <a class="code" href="gcontainer_8h.html#a13">g_container_get_iter</a>(<a class="code" href="structGIterator.html">GIterator</a> *iter, <span class="keyword">const</span> <a class="code" href="structGContainer.html">GContainer</a> *container) {
00222         iter-&gt;<a class="code" href="structGIterator.html#o1">index</a> = 0;
00223         iter-&gt;<a class="code" href="structGIterator.html#o0">type</a> = container-&gt;<a class="code" href="structGContainer.html#o0">type</a>;
00224         
00225         <span class="keywordflow">if</span> (container-&gt;<a class="code" href="structGContainer.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a0">GCONT_PTR_ARRAY</a>)
00226                 iter-&gt;<a class="code" href="structGIterator.html#o7">data</a>.array = (GPtrArray*)container-&gt;<a class="code" href="structGContainer.html#o2">data</a>;
00227         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (container-&gt;<a class="code" href="structGContainer.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a1">GCONT_LIST</a>) {
00228                 iter-&gt;<a class="code" href="structGIterator.html#o7">data</a>.list.curr = (GList*)container-&gt;<a class="code" href="structGContainer.html#o2">data</a>;
00229                 iter-&gt;<a class="code" href="structGIterator.html#o7">data</a>.list.last = g_list_last(container-&gt;<a class="code" href="structGContainer.html#o2">data</a>);
00230         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (container-&gt;<a class="code" href="structGContainer.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a2">GCONT_SLIST</a>)
00231                 iter-&gt;<a class="code" href="structGIterator.html#o7">data</a>.slistPtr = container-&gt;<a class="code" href="structGContainer.html#o2">data</a>;
00232         <span class="keywordflow">else</span> {
00233                 <a class="code" href="error_8h.html#a1">ERROR</a>(<span class="stringliteral">"Internal Error: Unrecognized type (%d)"</span>, container-&gt;<a class="code" href="structGContainer.html#o0">type</a>);
00234                 <span class="keywordflow">return</span> FALSE;
00235         }
00236         
00237         <span class="keywordflow">return</span> TRUE;
00238 }
00239 
00240 gboolean
<a name="l00241"></a><a class="code" href="gcontainer_8h.html#a14">00241</a> <a class="code" href="gcontainer_8h.html#a14">g_container_get_iter_last</a>(<a class="code" href="structGIterator.html">GIterator</a> *iter, <span class="keyword">const</span> <a class="code" href="structGContainer.html">GContainer</a> *container) {
00242         iter-&gt;<a class="code" href="structGIterator.html#o1">index</a> = container-&gt;<a class="code" href="structGContainer.html#o1">len</a>;
00243         iter-&gt;<a class="code" href="structGIterator.html#o0">type</a> = container-&gt;<a class="code" href="structGContainer.html#o0">type</a>;
00244         
00245         <span class="keywordflow">if</span> (container-&gt;<a class="code" href="structGContainer.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a0">GCONT_PTR_ARRAY</a>)
00246                 iter-&gt;<a class="code" href="structGIterator.html#o7">data</a>.array = (GPtrArray*)container-&gt;<a class="code" href="structGContainer.html#o2">data</a>;
00247         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (container-&gt;<a class="code" href="structGContainer.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a1">GCONT_LIST</a>) {
00248                 iter-&gt;<a class="code" href="structGIterator.html#o7">data</a>.list.curr = NULL; 
00249                 iter-&gt;<a class="code" href="structGIterator.html#o7">data</a>.list.last = g_list_last(container-&gt;<a class="code" href="structGContainer.html#o2">data</a>);
00250                 <span class="comment">/* iter-&gt;origList = container-&gt;data; */</span>
00251         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (container-&gt;<a class="code" href="structGContainer.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a2">GCONT_SLIST</a>) {
00252                 iter-&gt;<a class="code" href="structGIterator.html#o7">data</a>.slistPtr = g_slist_last(container-&gt;<a class="code" href="structGContainer.html#o2">data</a>);
00253         } <span class="keywordflow">else</span> {
00254                 <a class="code" href="error_8h.html#a1">ERROR</a>(<span class="stringliteral">"Internal Error: Unrecognized type (%d)"</span>, container-&gt;<a class="code" href="structGContainer.html#o0">type</a>);
00255                 <span class="keywordflow">return</span> FALSE;
00256         }
00257         
00258         <span class="keywordflow">return</span> TRUE;
00259 }
00260 
00261 gpointer
<a name="l00262"></a><a class="code" href="gcontainer_8h.html#a15">00262</a> <a class="code" href="gcontainer_8h.html#a15">g_iterator_get</a>(<span class="keyword">const</span> <a class="code" href="structGIterator.html">GIterator</a> *iter) {
00263         <span class="keywordflow">if</span> (iter-&gt;<a class="code" href="structGIterator.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a0">GCONT_PTR_ARRAY</a>)
00264                 <span class="keywordflow">return</span> g_ptr_array_index(iter-&gt;<a class="code" href="structGIterator.html#o7">data</a>.array, iter-&gt;<a class="code" href="structGIterator.html#o1">index</a>);
00265         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iter-&gt;<a class="code" href="structGIterator.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a1">GCONT_LIST</a>)
00266                 <span class="keywordflow">return</span> iter-&gt;<a class="code" href="structGIterator.html#o7">data</a>.list.curr-&gt;data;
00267         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iter-&gt;<a class="code" href="structGIterator.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a2">GCONT_SLIST</a>)
00268                 <span class="keywordflow">return</span> iter-&gt;<a class="code" href="structGIterator.html#o7">data</a>.slistPtr-&gt;data;
00269         <span class="keywordflow">else</span> {
00270                 <a class="code" href="error_8h.html#a1">ERROR</a>(<span class="stringliteral">"Internal Error: Unrecognized type (%d)"</span>, iter-&gt;<a class="code" href="structGIterator.html#o0">type</a>);
00271                 <span class="keywordflow">return</span> NULL;
00272         }
00273 }
00274 
00275 gpointer
<a name="l00276"></a><a class="code" href="gcontainer_8h.html#a16">00276</a> <a class="code" href="gcontainer_8h.html#a16">g_iterator_next</a>(<a class="code" href="structGIterator.html">GIterator</a> *iter) {
00277         gpointer data = <a class="code" href="gcontainer_8h.html#a15">g_iterator_get</a>(iter);
00278         
00279         <a class="code" href="gcontainer_8c.html#a0">iterNext</a>(iter);
00280         
00281         <span class="keywordflow">return</span> data;
00282 }
00283 
00284 gpointer
<a name="l00285"></a><a class="code" href="gcontainer_8h.html#a17">00285</a> <a class="code" href="gcontainer_8h.html#a17">g_iterator_prev</a>(<a class="code" href="structGIterator.html">GIterator</a> *iter) {
00286         <a class="code" href="gcontainer_8c.html#a1">iterPrev</a>(iter);
00287 
00288         <span class="keywordflow">return</span> <a class="code" href="gcontainer_8h.html#a15">g_iterator_get</a>(iter);
00289 }
00290 
00291 gboolean
<a name="l00292"></a><a class="code" href="gcontainer_8h.html#a18">00292</a> <a class="code" href="gcontainer_8h.html#a18">g_iterator_hasNext</a>(<span class="keyword">const</span> <a class="code" href="structGIterator.html">GIterator</a> *iter) {
00293         <span class="keywordflow">if</span> (iter-&gt;<a class="code" href="structGIterator.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a0">GCONT_PTR_ARRAY</a>)
00294                 <span class="keywordflow">return</span> (iter-&gt;<a class="code" href="structGIterator.html#o1">index</a> &lt; iter-&gt;<a class="code" href="structGIterator.html#o7">data</a>.array-&gt;len);
00295         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iter-&gt;<a class="code" href="structGIterator.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a1">GCONT_LIST</a>)
00296                 <span class="keywordflow">return</span> (iter-&gt;<a class="code" href="structGIterator.html#o7">data</a>.list.curr != NULL);
00297         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iter-&gt;<a class="code" href="structGIterator.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a2">GCONT_SLIST</a>)
00298                 <span class="keywordflow">return</span> (iter-&gt;<a class="code" href="structGIterator.html#o7">data</a>.slistPtr != NULL);
00299         <span class="keywordflow">else</span> {
00300                 <a class="code" href="error_8h.html#a1">ERROR</a>(<span class="stringliteral">"Internal Error: Unrecognized type (%d)"</span>, iter-&gt;<a class="code" href="structGIterator.html#o0">type</a>);
00301                 <span class="keywordflow">return</span> FALSE;
00302         }
00303 }
00304 
00305 gboolean
<a name="l00306"></a><a class="code" href="gcontainer_8h.html#a19">00306</a> <a class="code" href="gcontainer_8h.html#a19">g_iterator_hasPrev</a>(<span class="keyword">const</span> <a class="code" href="structGIterator.html">GIterator</a> *iter) {
00307         <span class="keywordflow">if</span> (iter-&gt;<a class="code" href="structGIterator.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a0">GCONT_PTR_ARRAY</a>)
00308                 <span class="keywordflow">return</span> (iter-&gt;<a class="code" href="structGIterator.html#o1">index</a> &gt; 0);
00309         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iter-&gt;<a class="code" href="structGIterator.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a1">GCONT_LIST</a>)
00310                 <span class="keywordflow">return</span> (iter-&gt;<a class="code" href="structGIterator.html#o7">data</a>.list.curr != NULL &amp;&amp; iter-&gt;<a class="code" href="structGIterator.html#o7">data</a>.list.curr-&gt;prev != NULL) || (iter-&gt;<a class="code" href="structGIterator.html#o7">data</a>.list.curr == NULL &amp;&amp; iter-&gt;<a class="code" href="structGIterator.html#o7">data</a>.list.last != NULL);
00311         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iter-&gt;<a class="code" href="structGIterator.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a2">GCONT_SLIST</a>) {
00312                 <a class="code" href="error_8h.html#a1">ERROR</a>(<span class="stringliteral">"Cannot traverse singly linked lists backwards"</span>);
00313                 <span class="keywordflow">return</span> FALSE;
00314         } <span class="keywordflow">else</span> {
00315                 <a class="code" href="error_8h.html#a1">ERROR</a>(<span class="stringliteral">"Internal Error: Unrecognized type (%d)"</span>, iter-&gt;<a class="code" href="structGIterator.html#o0">type</a>);
00316                 <span class="keywordflow">return</span> FALSE;
00317         }
00318 }
00319 
00320 <span class="keywordtype">void</span> *
<a name="l00321"></a><a class="code" href="gcontainer_8h.html#a20">00321</a> <a class="code" href="gcontainer_8h.html#a20">g_container_free</a>(<a class="code" href="structGContainer.html">GContainer</a> *container, gboolean freeAssoc) {
00322         <span class="keywordtype">void</span> *ret = NULL;
00323         
00324         <span class="keywordflow">if</span> (container != NULL) {
00325                 <span class="keywordflow">if</span> (freeAssoc) {
00326                         <span class="keywordflow">if</span> (container-&gt;<a class="code" href="structGContainer.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a0">GCONT_PTR_ARRAY</a>)
00327                                 g_ptr_array_free(container-&gt;<a class="code" href="structGContainer.html#o2">data</a>, TRUE);
00328                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (container-&gt;<a class="code" href="structGContainer.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a1">GCONT_LIST</a>)
00329                                 g_list_free(container-&gt;<a class="code" href="structGContainer.html#o2">data</a>);
00330                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (container-&gt;<a class="code" href="structGContainer.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a2">GCONT_SLIST</a>)
00331                                 g_slist_free(container-&gt;<a class="code" href="structGContainer.html#o2">data</a>);
00332                         <span class="keywordflow">else</span>
00333                                 <a class="code" href="error_8h.html#a1">ERROR</a>(<span class="stringliteral">"Internal Error: Unrecognized type (%d)"</span>, container-&gt;<a class="code" href="structGContainer.html#o0">type</a>);
00334                         
00335                         ret = NULL;
00336                 } <span class="keywordflow">else</span> {
00337                         ret = container-&gt;<a class="code" href="structGContainer.html#o2">data</a>;
00338                 }
00339         
00340                 g_free(container);
00341         }
00342         
00343         <span class="keywordflow">return</span> ret;
00344 }
00345 
00346 <span class="keywordtype">void</span> *
<a name="l00347"></a><a class="code" href="gcontainer_8h.html#a22">00347</a> <a class="code" href="gcontainer_8h.html#a22">g_container_convert</a>(GContType type, <a class="code" href="structGContainer.html">GContainer</a> *container) {
00348         <a class="code" href="structGContainer.html">GContainer</a> *newCont;
00349         <a class="code" href="structGIterator.html">GIterator</a> iter;
00350         gpointer data;
00351         
00352         <span class="keywordflow">if</span> (container == NULL) {
00353                 <a class="code" href="error_8h.html#a1">ERROR</a>(<span class="stringliteral">"Null pointer passed to g_container_convert"</span>);
00354                 <span class="keywordflow">return</span> NULL;
00355         }
00356         
00357         <span class="keywordflow">if</span> (type != container-&gt;<a class="code" href="structGContainer.html#o0">type</a>)
00358         {
00359                 newCont = <a class="code" href="gcontainer_8h.html#a3">g_container_new</a>(type);
00360         
00361                 <a class="code" href="gcontainer_8h.html#a13">g_container_get_iter</a>(&amp;iter, container);
00362                 <span class="keywordflow">while</span> (<a class="code" href="gcontainer_8h.html#a18">g_iterator_hasNext</a>(&amp;iter)) {
00363                         data = <a class="code" href="gcontainer_8h.html#a16">g_iterator_next</a>(&amp;iter);
00364                         <a class="code" href="gcontainer_8h.html#a6">g_container_add</a>(newCont, data);
00365                 }
00366                 
00367                 <span class="keywordflow">if</span> (container-&gt;<a class="code" href="structGContainer.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a0">GCONT_PTR_ARRAY</a>)
00368                         g_ptr_array_free(container-&gt;<a class="code" href="structGContainer.html#o2">data</a>, TRUE);
00369                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (container-&gt;<a class="code" href="structGContainer.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a1">GCONT_LIST</a>)
00370                         g_list_free(container-&gt;<a class="code" href="structGContainer.html#o2">data</a>);
00371                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (container-&gt;<a class="code" href="structGContainer.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a2">GCONT_SLIST</a>)
00372                         g_slist_free(container-&gt;<a class="code" href="structGContainer.html#o2">data</a>);
00373                 <span class="keywordflow">else</span>
00374                         <a class="code" href="error_8h.html#a1">ERROR</a>(<span class="stringliteral">"Internal Error: Unrecognized type (%d)"</span>, container-&gt;<a class="code" href="structGContainer.html#o0">type</a>);
00375                 
00376                 container-&gt;<a class="code" href="structGContainer.html#o2">data</a> = newCont-&gt;<a class="code" href="structGContainer.html#o2">data</a>;
00377                 container-&gt;<a class="code" href="structGContainer.html#o0">type</a> = type;
00378                 
00379                 <a class="code" href="gcontainer_8h.html#a20">g_container_free</a>(newCont, FALSE);
00380         }
00381         
00382         <span class="keywordflow">return</span> container-&gt;<a class="code" href="structGContainer.html#o2">data</a>;
00383 }
00384 
00393 <span class="keywordtype">void</span>
<a name="l00394"></a><a class="code" href="gcontainer_8h.html#a21">00394</a> <a class="code" href="gcontainer_8h.html#a21">g_container_copy</a>(<a class="code" href="structGContainer.html">GContainer</a> *dest, <span class="keyword">const</span> <a class="code" href="structGContainer.html">GContainer</a> *src) {
00395         <a class="code" href="structGIterator.html">GIterator</a> iter;
00396         gpointer curr;
00397         
00398         <span class="keywordflow">if</span> (dest == NULL || src == NULL) {
00399                 <a class="code" href="error_8h.html#a1">ERROR</a>(<span class="stringliteral">"Null pointer passed to g_container_copy"</span>);
00400         } <span class="keywordflow">else</span> {
00401                 <a class="code" href="gcontainer_8h.html#a13">g_container_get_iter</a>(&amp;iter, src);
00402                 <span class="keywordflow">while</span> (<a class="code" href="gcontainer_8h.html#a18">g_iterator_hasNext</a>(&amp;iter)) {
00403                         curr = <a class="code" href="gcontainer_8h.html#a16">g_iterator_next</a>(&amp;iter);
00404                         <a class="code" href="gcontainer_8h.html#a6">g_container_add</a>(dest, curr);
00405                 }
00406         }
00407 }
00408 
00415 <span class="keywordtype">void</span>
<a name="l00416"></a><a class="code" href="gcontainer_8h.html#a23">00416</a> <a class="code" href="gcontainer_8h.html#a23">g_container_destroy</a>(<a class="code" href="structGContainer.html">GContainer</a> *array) {
00417         <a class="code" href="structGIterator.html">GIterator</a> iter;
00418         gpointer ptr;
00419         
00420         <span class="keywordflow">if</span> (array == NULL) {
00421                 <a class="code" href="error_8h.html#a1">ERROR</a>(<span class="stringliteral">"Null pointer passed to g_container_destroy"</span>);
00422                 <span class="keywordflow">return</span>;
00423         }
00424         
00425         <a class="code" href="gcontainer_8h.html#a13">g_container_get_iter</a>(&amp;iter, array);
00426         <span class="keywordflow">while</span> (<a class="code" href="gcontainer_8h.html#a18">g_iterator_hasNext</a>(&amp;iter)) {
00427                 ptr = <a class="code" href="gcontainer_8h.html#a16">g_iterator_next</a>(&amp;iter);
00428                 g_free(ptr);
00429         }
00430         
00431         <a class="code" href="gcontainer_8h.html#a20">g_container_free</a>(array, TRUE);
00432 }
00433 
00434 <span class="keywordtype">void</span>
<a name="l00435"></a><a class="code" href="gcontainer_8h.html#a24">00435</a> <a class="code" href="gcontainer_8h.html#a24">g_container_destroy_type</a>(GContType type, <span class="keywordtype">void</span> *array) {
00436         <a class="code" href="structGContainer.html">GContainer</a> *cont;
00437         
00438         <span class="keywordflow">if</span> (array == NULL) {
00439                 <a class="code" href="error_8h.html#a1">ERROR</a>(<span class="stringliteral">"Null pointer passed to g_container_destroy_type"</span>);
00440                 <span class="keywordflow">return</span>;
00441         }
00442         
00443         cont = <a class="code" href="gcontainer_8h.html#a4">g_container_new_from_data</a>(type, array);
00444         <a class="code" href="gcontainer_8h.html#a23">g_container_destroy</a>(cont);
00445 }
00446 
00447 
00448 <span class="comment">/* -- Non-Interface Methods -- */</span>
00449 
00450 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00451"></a><a class="code" href="gcontainer_8c.html#a0">00451</a> <a class="code" href="gcontainer_8c.html#a0">iterNext</a>(<a class="code" href="structGIterator.html">GIterator</a> *iter) {
00452         iter-&gt;<a class="code" href="structGIterator.html#o1">index</a>++;
00453         
00454         <span class="keywordflow">if</span> (iter-&gt;<a class="code" href="structGIterator.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a0">GCONT_PTR_ARRAY</a>)
00455                 <span class="comment">/* do nothing */</span>;
00456         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iter-&gt;<a class="code" href="structGIterator.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a1">GCONT_LIST</a>)
00457                 iter-&gt;<a class="code" href="structGIterator.html#o7">data</a>.list.curr = iter-&gt;<a class="code" href="structGIterator.html#o7">data</a>.list.curr-&gt;next;
00458         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iter-&gt;<a class="code" href="structGIterator.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a2">GCONT_SLIST</a>)
00459                 iter-&gt;<a class="code" href="structGIterator.html#o7">data</a>.slistPtr = iter-&gt;<a class="code" href="structGIterator.html#o7">data</a>.slistPtr-&gt;next;
00460         <span class="keywordflow">else</span>
00461                 <a class="code" href="error_8h.html#a1">ERROR</a>(<span class="stringliteral">"Internal Error: Unrecognized type (%d)"</span>, iter-&gt;<a class="code" href="structGIterator.html#o0">type</a>);
00462 }
00463 
00464 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00465"></a><a class="code" href="gcontainer_8c.html#a1">00465</a> <a class="code" href="gcontainer_8c.html#a1">iterPrev</a>(<a class="code" href="structGIterator.html">GIterator</a> *iter) {
00466         iter-&gt;<a class="code" href="structGIterator.html#o1">index</a>--;
00467         
00468         <span class="keywordflow">if</span> (iter-&gt;<a class="code" href="structGIterator.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a0">GCONT_PTR_ARRAY</a>)
00469                 <span class="comment">/* do nothing */</span>;
00470         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iter-&gt;<a class="code" href="structGIterator.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a1">GCONT_LIST</a>) {
00471                 <span class="keywordflow">if</span> (iter-&gt;<a class="code" href="structGIterator.html#o7">data</a>.list.curr == NULL)
00472                         iter-&gt;<a class="code" href="structGIterator.html#o7">data</a>.list.curr = iter-&gt;<a class="code" href="structGIterator.html#o7">data</a>.list.last;
00473                 <span class="keywordflow">else</span>
00474                         iter-&gt;<a class="code" href="structGIterator.html#o7">data</a>.list.curr = iter-&gt;<a class="code" href="structGIterator.html#o7">data</a>.list.curr-&gt;prev;
00475         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iter-&gt;<a class="code" href="structGIterator.html#o0">type</a> == <a class="code" href="gcontainer_8h.html#a25a2">GCONT_SLIST</a>)
00476                 <a class="code" href="error_8h.html#a1">ERROR</a>(<span class="stringliteral">"g_iterator_prev operation not valid on singly linked lists!"</span>);
00477         <span class="keywordflow">else</span>
00478                 <a class="code" href="error_8h.html#a1">ERROR</a>(<span class="stringliteral">"Internal Error: Unrecognized type (%d)"</span>, iter-&gt;<a class="code" href="structGIterator.html#o0">type</a>);
00479 }
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat Jan 15 16:52:30 2005 for luau by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
