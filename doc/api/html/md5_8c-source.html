<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>luau: md5.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a></div>
<h1>md5.c</h1><a href="md5_8c.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*</span>
00002 <span class="comment"> * luau (Lib Update/Auto-Update): Simple Update Library</span>
00003 <span class="comment"> * Copyright (C) 2003  David Eklund</span>
00004 <span class="comment"> *</span>
00005 <span class="comment"> * - This library is free software; you can redistribute it and/or             -</span>
00006 <span class="comment"> * - modify it under the terms of the GNU Lesser General Public                -</span>
00007 <span class="comment"> * - License as published by the Free Software Foundation; either              -</span>
00008 <span class="comment"> * - version 2.1 of the License, or (at your option) any later version.        -</span>
00009 <span class="comment"> * -                                                                           -</span>
00010 <span class="comment"> * - This library is distributed in the hope that it will be useful,           -</span>
00011 <span class="comment"> * - but WITHOUT ANY WARRANTY; without even the implied warranty of            -</span>
00012 <span class="comment"> * - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU         -</span>
00013 <span class="comment"> * - Lesser General Public License for more details.                           -</span>
00014 <span class="comment"> * -                                                                           -</span>
00015 <span class="comment"> * - You should have received a copy of the GNU Lesser General Public          -</span>
00016 <span class="comment"> * - License along with this library; if not, write to the Free Software       -</span>
00017 <span class="comment"> * - Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA -</span>
00018 <span class="comment"> */</span>
00019  
00020 <span class="comment">/*</span>
00021 <span class="comment"> * md5.h and md5.c are based off of md5hl.c, md5c.c, and md5.h from libmd, which in turn is</span>
00022 <span class="comment"> * based off the FreeBSD libmd library.  Their respective copyright notices follow:</span>
00023 <span class="comment"> */</span>
00024 
00025 <span class="comment">/*</span>
00026 <span class="comment"> * This code implements the MD5 message-digest algorithm.</span>
00027 <span class="comment"> * The algorithm is due to Ron Rivest.  This code was</span>
00028 <span class="comment"> * written by Colin Plumb in 1993, no copyright is claimed.</span>
00029 <span class="comment"> * This code is in the public domain; do with it what you wish.</span>
00030 <span class="comment"> *</span>
00031 <span class="comment"> * Equivalent code is available from RSA Data Security, Inc.</span>
00032 <span class="comment"> * This code has been tested against that, and is equivalent,</span>
00033 <span class="comment"> * except that you don't need to include two pages of legalese</span>
00034 <span class="comment"> * with every copy.</span>
00035 <span class="comment"> */</span>
00036 
00037 <span class="comment">/* ----------------------------------------------------------------------------</span>
00038 <span class="comment"> * "THE BEER-WARE LICENSE" (Revision 42):</span>
00039 <span class="comment"> * &lt;phk@login.dkuug.dk&gt; wrote this file.  As long as you retain this notice you</span>
00040 <span class="comment"> * can do whatever you want with this stuff. If we meet some day, and you think</span>
00041 <span class="comment"> * this stuff is worth it, you can buy me a beer in return.   Poul-Henning Kamp</span>
00042 <span class="comment"> * ----------------------------------------------------------------------------</span>
00043 <span class="comment"> *</span>
00044 <span class="comment"> * $Id: md5_8c-source.html,v 1.4 2005/01/16 00:53:58 deklund2 Exp $</span>
00045 <span class="comment"> *</span>
00046 <span class="comment"> */</span>
00047 
00048 <span class="preprocessor">#ifdef HAVE_CONFIG_H</span>
00049 <span class="preprocessor"></span><span class="preprocessor">#  include &lt;config.h&gt;</span>
00050 <span class="preprocessor">#endif</span>
00051 <span class="preprocessor"></span>
00052 <span class="preprocessor">#include &lt;sys/types.h&gt;</span>
00053 <span class="preprocessor">#include &lt;fcntl.h&gt;</span>
00054 <span class="preprocessor">#include &lt;unistd.h&gt;</span>
00055 <span class="preprocessor">#include &lt;errno.h&gt;</span>
00056 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
00057 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
00058 <span class="preprocessor">#include &lt;string.h&gt;</span>
00059 
00060 <span class="preprocessor">#include "<a class="code" href="md5_8h.html">md5.h</a>"</span>
00061 <span class="preprocessor">#ifdef WITH_DMALLOC</span>
00062 <span class="preprocessor"></span><span class="preprocessor">#  include &lt;dmalloc.h&gt;</span>
00063 <span class="preprocessor">#endif</span>
00064 <span class="preprocessor"></span>
00065 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="md5_8c.html#a5">MD5Init</a>(<a class="code" href="structMD5Context.html">MD5_CTX</a> *context);
00066 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="md5_8c.html#a6">MD5Update</a>(<a class="code" href="structMD5Context.html">MD5_CTX</a> *context, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <span class="keyword">const</span> *buf, <span class="keywordtype">unsigned</span> len);
00067 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="md5_8c.html#a13">MD5Final</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> digest[MD5_HASHBYTES], <a class="code" href="structMD5Context.html">MD5_CTX</a> *context);
00068 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="md5_8c.html#a8">MD5Transform</a>(u_int32_t buf[4], u_int32_t <span class="keyword">const</span> in[16]);
00069 <span class="keyword">static</span> <span class="keywordtype">char</span>* <a class="code" href="md5_8c.html#a9">MD5End</a>(<a class="code" href="structMD5Context.html">MD5_CTX</a> *, <span class="keywordtype">char</span> *);
00070 
00071 
00072 <span class="preprocessor">#if __BYTE_ORDER == 1234</span>
00073 <span class="preprocessor"></span><span class="preprocessor">#define byteReverse(buf, len)   </span><span class="comment">/* Nothing */</span>
00074 <span class="preprocessor">#else</span>
00075 <span class="preprocessor"></span><span class="keywordtype">void</span> <a class="code" href="md5_8c.html#a10">byteReverse</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *buf, <span class="keywordtype">unsigned</span> longs);
00076 
00077 <span class="comment">/*</span>
00078 <span class="comment"> * Note: this code is harmless on little-endian machines.</span>
00079 <span class="comment"> */</span>
<a name="l00080"></a><a class="code" href="md5_8c.html#a10">00080</a> <span class="keywordtype">void</span> <a class="code" href="md5_8c.html#a10">byteReverse</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *buf, <span class="keywordtype">unsigned</span> longs)
00081 {
00082     u_int32_t t;
00083     <span class="keywordflow">do</span> {
00084         t = (u_int32_t) ((<span class="keywordtype">unsigned</span>) buf[3] &lt;&lt; 8 | buf[2]) &lt;&lt; 16 |
00085             ((<span class="keywordtype">unsigned</span>) buf[1] &lt;&lt; 8 | buf[0]);
00086         *(u_int32_t *) buf = t;
00087         buf += 4;
00088     } <span class="keywordflow">while</span> (--longs);
00089 }
00090 <span class="preprocessor">#endif </span><span class="comment">/* ! __BYTE_ORDER == 1234 */</span>
00091 
00092 
00093 
00094 
00095 <span class="keywordtype">char</span> *
<a name="l00096"></a><a class="code" href="md5_8h.html#a2">00096</a> <a class="code" href="md5_8h.html#a2">lutil_md5_file</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *filename, <span class="keywordtype">char</span> *buf, GError **err)
00097 {
00098     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> buffer[BUFSIZ]; 
00099     <a class="code" href="structMD5Context.html">MD5_CTX</a> ctx;
00100     <span class="keywordtype">int</span> f,i,j;
00101         
00102         g_return_val_if_fail(err == NULL || *err == NULL, NULL);
00103 
00104     <a class="code" href="md5_8c.html#a5">MD5Init</a>(&amp;ctx);
00105     f = open(filename,O_RDONLY);
00106     <span class="keywordflow">if</span> (f &lt; 0) {
00107                 g_set_error(err, <a class="code" href="util_8h.html#a6">LUTIL_BASE_ERROR</a>, <a class="code" href="util_8h.html#a33a8">LUTIL_BASE_ERROR_FAILED</a>, <span class="stringliteral">"Couldn't open file '%s' for reading: %s"</span>, filename, strerror(errno));
00108                 <span class="keywordflow">return</span> NULL;
00109         }
00110     <span class="keywordflow">while</span> ((i = read(f,buffer,<span class="keyword">sizeof</span> buffer)) &gt; 0) {
00111                 <a class="code" href="md5_8c.html#a6">MD5Update</a>(&amp;ctx,buffer,i);
00112     }
00113     j = errno;
00114     close(f);
00115     errno = j;
00116     <span class="keywordflow">if</span> (i &lt; 0) {
00117                 g_set_error(err, <a class="code" href="util_8h.html#a6">LUTIL_BASE_ERROR</a>, <a class="code" href="util_8h.html#a33a8">LUTIL_BASE_ERROR_FAILED</a>, <span class="stringliteral">"Error reading open file '%s': %s"</span>, filename, strerror(errno));
00118                 <span class="keywordflow">return</span> NULL;
00119         }
00120     <span class="keywordflow">return</span> <a class="code" href="md5_8c.html#a9">MD5End</a>(&amp;ctx, buf);
00121 }
00122 
00123 <span class="keywordtype">char</span> *
<a name="l00124"></a><a class="code" href="md5_8h.html#a3">00124</a> <a class="code" href="md5_8h.html#a3">lutil_md5_data</a> (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *data, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> len, <span class="keywordtype">char</span> *buf, GError **err)
00125 {
00126     <a class="code" href="structMD5Context.html">MD5_CTX</a> ctx;
00127         
00128         g_return_val_if_fail(err == NULL || *err == NULL, NULL);
00129 
00130     <a class="code" href="md5_8c.html#a5">MD5Init</a>(&amp;ctx);
00131     <a class="code" href="md5_8c.html#a6">MD5Update</a>(&amp;ctx,data,len);
00132     <span class="keywordflow">return</span> <a class="code" href="md5_8c.html#a9">MD5End</a>(&amp;ctx, buf);
00133 }
00134                                    
00135                                   
00136 <span class="comment">/* Non-Interface Methods */</span>
00137 
00138 <span class="comment">/* from md5hl.c */</span>
00139 
00140 <span class="keywordtype">char</span> *
<a name="l00141"></a><a class="code" href="md5_8c.html#a9">00141</a> <a class="code" href="md5_8c.html#a9">MD5End</a>(<a class="code" href="structMD5Context.html">MD5_CTX</a> *ctx, <span class="keywordtype">char</span> *buf)
00142 {
00143     <span class="keywordtype">int</span> i;
00144     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> digest[<a class="code" href="md5_8h.html#a0">MD5_HASHBYTES</a>];
00145     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> hex[]=<span class="stringliteral">"0123456789abcdef"</span>;
00146 
00147     <span class="keywordflow">if</span> (!buf)
00148         buf = malloc(33);
00149     <span class="keywordflow">if</span> (!buf)
00150         <span class="keywordflow">return</span> 0;
00151     <a class="code" href="md5_8c.html#a13">MD5Final</a>(digest,ctx);
00152     <span class="keywordflow">for</span> (i=0;i&lt;<a class="code" href="md5_8h.html#a0">MD5_HASHBYTES</a>;i++) {
00153         buf[i+i] = hex[digest[i] &gt;&gt; 4];
00154         buf[i+i+1] = hex[digest[i] &amp; 0x0f];
00155     }
00156     buf[i+i] = <span class="charliteral">'\0'</span>;
00157     <span class="keywordflow">return</span> buf;
00158 }
00159 
00160 <span class="comment">/*</span>
00161 <span class="comment"> * Start MD5 accumulation.  Set bit count to 0 and buffer to mysterious</span>
00162 <span class="comment"> * initialization constants.</span>
00163 <span class="comment"> */</span>
<a name="l00164"></a><a class="code" href="md5_8c.html#a5">00164</a> <span class="keywordtype">void</span> <a class="code" href="md5_8c.html#a5">MD5Init</a>(<a class="code" href="structMD5Context.html">MD5_CTX</a> *ctx)
00165 {
00166     ctx-&gt;<a class="code" href="structMD5Context.html#o0">buf</a>[0] = 0x67452301;
00167     ctx-&gt;<a class="code" href="structMD5Context.html#o0">buf</a>[1] = 0xefcdab89;
00168     ctx-&gt;<a class="code" href="structMD5Context.html#o0">buf</a>[2] = 0x98badcfe;
00169     ctx-&gt;<a class="code" href="structMD5Context.html#o0">buf</a>[3] = 0x10325476;
00170 
00171     ctx-&gt;<a class="code" href="structMD5Context.html#o1">bits</a>[0] = 0;
00172     ctx-&gt;<a class="code" href="structMD5Context.html#o1">bits</a>[1] = 0;
00173 }
00174 
00175 <span class="comment">/*</span>
00176 <span class="comment"> * Update context to reflect the concatenation of another buffer full</span>
00177 <span class="comment"> * of bytes.</span>
00178 <span class="comment"> */</span>
<a name="l00179"></a><a class="code" href="md5_8c.html#a6">00179</a> <span class="keywordtype">void</span> <a class="code" href="md5_8c.html#a6">MD5Update</a>(<a class="code" href="structMD5Context.html">MD5_CTX</a> *ctx, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <span class="keyword">const</span> *buf, <span class="keywordtype">unsigned</span> len)
00180 {
00181     u_int32_t t;
00182 
00183     <span class="comment">/* Update bitcount */</span>
00184 
00185     t = ctx-&gt;<a class="code" href="structMD5Context.html#o1">bits</a>[0];
00186     <span class="keywordflow">if</span> ((ctx-&gt;<a class="code" href="structMD5Context.html#o1">bits</a>[0] = t + ((u_int32_t) len &lt;&lt; 3)) &lt; t)
00187         ctx-&gt;<a class="code" href="structMD5Context.html#o1">bits</a>[1]++;         <span class="comment">/* Carry from low to high */</span>
00188     ctx-&gt;<a class="code" href="structMD5Context.html#o1">bits</a>[1] += len &gt;&gt; 29;
00189 
00190     t = (t &gt;&gt; 3) &amp; 0x3f;        <span class="comment">/* Bytes already in shsInfo-&gt;data */</span>
00191 
00192     <span class="comment">/* Handle any leading odd-sized chunks */</span>
00193 
00194     <span class="keywordflow">if</span> (t) {
00195         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *p = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) ctx-&gt;<a class="code" href="structMD5Context.html#o2">in</a> + t;
00196 
00197         t = 64 - t;
00198         <span class="keywordflow">if</span> (len &lt; t) {
00199             memcpy(p, buf, len);
00200             <span class="keywordflow">return</span>;
00201         }
00202         memcpy(p, buf, t);
00203         <a class="code" href="md5_8c.html#a10">byteReverse</a>(ctx-&gt;<a class="code" href="structMD5Context.html#o2">in</a>, 16);
00204         <a class="code" href="md5_8c.html#a8">MD5Transform</a>(ctx-&gt;<a class="code" href="structMD5Context.html#o0">buf</a>, (u_int32_t *) ctx-&gt;<a class="code" href="structMD5Context.html#o2">in</a>);
00205         buf += t;
00206         len -= t;
00207     }
00208     <span class="comment">/* Process data in 64-byte chunks */</span>
00209 
00210     <span class="keywordflow">while</span> (len &gt;= 64) {
00211         memcpy(ctx-&gt;<a class="code" href="structMD5Context.html#o2">in</a>, buf, 64);
00212         <a class="code" href="md5_8c.html#a10">byteReverse</a>(ctx-&gt;<a class="code" href="structMD5Context.html#o2">in</a>, 16);
00213         <a class="code" href="md5_8c.html#a8">MD5Transform</a>(ctx-&gt;<a class="code" href="structMD5Context.html#o0">buf</a>, (u_int32_t *) ctx-&gt;<a class="code" href="structMD5Context.html#o2">in</a>);
00214         buf += 64;
00215         len -= 64;
00216     }
00217 
00218     <span class="comment">/* Handle any remaining bytes of data. */</span>
00219 
00220     memcpy(ctx-&gt;<a class="code" href="structMD5Context.html#o2">in</a>, buf, len);
00221 }
00222 
00223 <span class="comment">/*</span>
00224 <span class="comment"> * Final wrapup - pad to 64-byte boundary with the bit pattern </span>
00225 <span class="comment"> * 1 0* (64-bit count of bits processed, MSB-first)</span>
00226 <span class="comment"> */</span>
<a name="l00227"></a><a class="code" href="md5_8c.html#a13">00227</a> <span class="keywordtype">void</span> <a class="code" href="md5_8c.html#a13">MD5Final</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> digest[16], <a class="code" href="structMD5Context.html">MD5_CTX</a> *ctx)
00228 {
00229     <span class="keywordtype">unsigned</span> count;
00230     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *p;
00231 
00232     <span class="comment">/* Compute number of bytes mod 64 */</span>
00233     count = (ctx-&gt;<a class="code" href="structMD5Context.html#o1">bits</a>[0] &gt;&gt; 3) &amp; 0x3F;
00234 
00235     <span class="comment">/* Set the first char of padding to 0x80.  This is safe since there is</span>
00236 <span class="comment">       always at least one byte free */</span>
00237     p = ctx-&gt;<a class="code" href="structMD5Context.html#o2">in</a> + count;
00238     *p++ = 0x80;
00239 
00240     <span class="comment">/* Bytes of padding needed to make 64 bytes */</span>
00241     count = 64 - 1 - count;
00242 
00243     <span class="comment">/* Pad out to 56 mod 64 */</span>
00244     <span class="keywordflow">if</span> (count &lt; 8) {
00245         <span class="comment">/* Two lots of padding:  Pad the first block to 64 bytes */</span>
00246         memset(p, 0, count);
00247         <a class="code" href="md5_8c.html#a10">byteReverse</a>(ctx-&gt;<a class="code" href="structMD5Context.html#o2">in</a>, 16);
00248         <a class="code" href="md5_8c.html#a8">MD5Transform</a>(ctx-&gt;<a class="code" href="structMD5Context.html#o0">buf</a>, (u_int32_t *) ctx-&gt;<a class="code" href="structMD5Context.html#o2">in</a>);
00249 
00250         <span class="comment">/* Now fill the next block with 56 bytes */</span>
00251         memset(ctx-&gt;<a class="code" href="structMD5Context.html#o2">in</a>, 0, 56);
00252     } <span class="keywordflow">else</span> {
00253         <span class="comment">/* Pad block to 56 bytes */</span>
00254         memset(p, 0, count - 8);
00255     }
00256     <a class="code" href="md5_8c.html#a10">byteReverse</a>(ctx-&gt;<a class="code" href="structMD5Context.html#o2">in</a>, 14);
00257 
00258     <span class="comment">/* Append length in bits and transform */</span>
00259     ((u_int32_t *) ctx-&gt;<a class="code" href="structMD5Context.html#o2">in</a>)[14] = ctx-&gt;<a class="code" href="structMD5Context.html#o1">bits</a>[0];
00260     ((u_int32_t *) ctx-&gt;<a class="code" href="structMD5Context.html#o2">in</a>)[15] = ctx-&gt;<a class="code" href="structMD5Context.html#o1">bits</a>[1];
00261 
00262     <a class="code" href="md5_8c.html#a8">MD5Transform</a>(ctx-&gt;<a class="code" href="structMD5Context.html#o0">buf</a>, (u_int32_t *) ctx-&gt;<a class="code" href="structMD5Context.html#o2">in</a>);
00263     <a class="code" href="md5_8c.html#a10">byteReverse</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *) ctx-&gt;<a class="code" href="structMD5Context.html#o0">buf</a>, 4);
00264     memcpy(digest, ctx-&gt;<a class="code" href="structMD5Context.html#o0">buf</a>, 16);
00265     memset((<span class="keywordtype">char</span> *) ctx, 0, <span class="keyword">sizeof</span>(ctx));       <span class="comment">/* In case it's sensitive */</span>
00266 }
00267 
00268 <span class="comment">/* The four core functions - F1 is optimized somewhat */</span>
00269 
00270 <span class="comment">/* #define F1(x, y, z) (x &amp; y | ~x &amp; z) */</span>
<a name="l00271"></a><a class="code" href="md5_8c.html#a0">00271</a> <span class="preprocessor">#define F1(x, y, z) (z ^ (x &amp; (y ^ z)))</span>
<a name="l00272"></a><a class="code" href="md5_8c.html#a1">00272</a> <span class="preprocessor"></span><span class="preprocessor">#define F2(x, y, z) F1(z, x, y)</span>
<a name="l00273"></a><a class="code" href="md5_8c.html#a2">00273</a> <span class="preprocessor"></span><span class="preprocessor">#define F3(x, y, z) (x ^ y ^ z)</span>
<a name="l00274"></a><a class="code" href="md5_8c.html#a3">00274</a> <span class="preprocessor"></span><span class="preprocessor">#define F4(x, y, z) (y ^ (x | ~z))</span>
00275 <span class="preprocessor"></span>
00276 <span class="comment">/* This is the central step in the MD5 algorithm. */</span>
<a name="l00277"></a><a class="code" href="md5_8c.html#a4">00277</a> <span class="preprocessor">#define MD5STEP(f, w, x, y, z, data, s) \</span>
00278 <span class="preprocessor">        ( w += f(x, y, z) + data,  w = w&lt;&lt;s | w&gt;&gt;(32-s),  w += x )</span>
00279 <span class="preprocessor"></span>
00280 <span class="comment">/*</span>
00281 <span class="comment"> * The core of the MD5 algorithm, this alters an existing MD5 hash to</span>
00282 <span class="comment"> * reflect the addition of 16 longwords of new data.  MD5Update blocks</span>
00283 <span class="comment"> * the data and converts bytes into longwords for this routine.</span>
00284 <span class="comment"> */</span>
<a name="l00285"></a><a class="code" href="md5_8c.html#a8">00285</a> <span class="keywordtype">void</span> <a class="code" href="md5_8c.html#a8">MD5Transform</a>(u_int32_t buf[4], u_int32_t <span class="keyword">const</span> in[16])
00286 {
00287     <span class="keyword">register</span> u_int32_t a, b, c, d;
00288 
00289     a = buf[0];
00290     b = buf[1];
00291     c = buf[2];
00292     d = buf[3];
00293 
00294     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a0">F1</a>, a, b, c, d, in[0] + 0xd76aa478, 7);
00295     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a0">F1</a>, d, a, b, c, in[1] + 0xe8c7b756, 12);
00296     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a0">F1</a>, c, d, a, b, in[2] + 0x242070db, 17);
00297     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a0">F1</a>, b, c, d, a, in[3] + 0xc1bdceee, 22);
00298     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a0">F1</a>, a, b, c, d, in[4] + 0xf57c0faf, 7);
00299     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a0">F1</a>, d, a, b, c, in[5] + 0x4787c62a, 12);
00300     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a0">F1</a>, c, d, a, b, in[6] + 0xa8304613, 17);
00301     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a0">F1</a>, b, c, d, a, in[7] + 0xfd469501, 22);
00302     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a0">F1</a>, a, b, c, d, in[8] + 0x698098d8, 7);
00303     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a0">F1</a>, d, a, b, c, in[9] + 0x8b44f7af, 12);
00304     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a0">F1</a>, c, d, a, b, in[10] + 0xffff5bb1, 17);
00305     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a0">F1</a>, b, c, d, a, in[11] + 0x895cd7be, 22);
00306     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a0">F1</a>, a, b, c, d, in[12] + 0x6b901122, 7);
00307     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a0">F1</a>, d, a, b, c, in[13] + 0xfd987193, 12);
00308     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a0">F1</a>, c, d, a, b, in[14] + 0xa679438e, 17);
00309     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a0">F1</a>, b, c, d, a, in[15] + 0x49b40821, 22);
00310 
00311     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a1">F2</a>, a, b, c, d, in[1] + 0xf61e2562, 5);
00312     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a1">F2</a>, d, a, b, c, in[6] + 0xc040b340, 9);
00313     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a1">F2</a>, c, d, a, b, in[11] + 0x265e5a51, 14);
00314     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a1">F2</a>, b, c, d, a, in[0] + 0xe9b6c7aa, 20);
00315     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a1">F2</a>, a, b, c, d, in[5] + 0xd62f105d, 5);
00316     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a1">F2</a>, d, a, b, c, in[10] + 0x02441453, 9);
00317     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a1">F2</a>, c, d, a, b, in[15] + 0xd8a1e681, 14);
00318     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a1">F2</a>, b, c, d, a, in[4] + 0xe7d3fbc8, 20);
00319     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a1">F2</a>, a, b, c, d, in[9] + 0x21e1cde6, 5);
00320     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a1">F2</a>, d, a, b, c, in[14] + 0xc33707d6, 9);
00321     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a1">F2</a>, c, d, a, b, in[3] + 0xf4d50d87, 14);
00322     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a1">F2</a>, b, c, d, a, in[8] + 0x455a14ed, 20);
00323     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a1">F2</a>, a, b, c, d, in[13] + 0xa9e3e905, 5);
00324     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a1">F2</a>, d, a, b, c, in[2] + 0xfcefa3f8, 9);
00325     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a1">F2</a>, c, d, a, b, in[7] + 0x676f02d9, 14);
00326     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a1">F2</a>, b, c, d, a, in[12] + 0x8d2a4c8a, 20);
00327 
00328     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a2">F3</a>, a, b, c, d, in[5] + 0xfffa3942, 4);
00329     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a2">F3</a>, d, a, b, c, in[8] + 0x8771f681, 11);
00330     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a2">F3</a>, c, d, a, b, in[11] + 0x6d9d6122, 16);
00331     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a2">F3</a>, b, c, d, a, in[14] + 0xfde5380c, 23);
00332     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a2">F3</a>, a, b, c, d, in[1] + 0xa4beea44, 4);
00333     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a2">F3</a>, d, a, b, c, in[4] + 0x4bdecfa9, 11);
00334     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a2">F3</a>, c, d, a, b, in[7] + 0xf6bb4b60, 16);
00335     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a2">F3</a>, b, c, d, a, in[10] + 0xbebfbc70, 23);
00336     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a2">F3</a>, a, b, c, d, in[13] + 0x289b7ec6, 4);
00337     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a2">F3</a>, d, a, b, c, in[0] + 0xeaa127fa, 11);
00338     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a2">F3</a>, c, d, a, b, in[3] + 0xd4ef3085, 16);
00339     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a2">F3</a>, b, c, d, a, in[6] + 0x04881d05, 23);
00340     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a2">F3</a>, a, b, c, d, in[9] + 0xd9d4d039, 4);
00341     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a2">F3</a>, d, a, b, c, in[12] + 0xe6db99e5, 11);
00342     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a2">F3</a>, c, d, a, b, in[15] + 0x1fa27cf8, 16);
00343     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a2">F3</a>, b, c, d, a, in[2] + 0xc4ac5665, 23);
00344 
00345     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a3">F4</a>, a, b, c, d, in[0] + 0xf4292244, 6);
00346     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a3">F4</a>, d, a, b, c, in[7] + 0x432aff97, 10);
00347     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a3">F4</a>, c, d, a, b, in[14] + 0xab9423a7, 15);
00348     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a3">F4</a>, b, c, d, a, in[5] + 0xfc93a039, 21);
00349     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a3">F4</a>, a, b, c, d, in[12] + 0x655b59c3, 6);
00350     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a3">F4</a>, d, a, b, c, in[3] + 0x8f0ccc92, 10);
00351     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a3">F4</a>, c, d, a, b, in[10] + 0xffeff47d, 15);
00352     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a3">F4</a>, b, c, d, a, in[1] + 0x85845dd1, 21);
00353     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a3">F4</a>, a, b, c, d, in[8] + 0x6fa87e4f, 6);
00354     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a3">F4</a>, d, a, b, c, in[15] + 0xfe2ce6e0, 10);
00355     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a3">F4</a>, c, d, a, b, in[6] + 0xa3014314, 15);
00356     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a3">F4</a>, b, c, d, a, in[13] + 0x4e0811a1, 21);
00357     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a3">F4</a>, a, b, c, d, in[4] + 0xf7537e82, 6);
00358     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a3">F4</a>, d, a, b, c, in[11] + 0xbd3af235, 10);
00359     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a3">F4</a>, c, d, a, b, in[2] + 0x2ad7d2bb, 15);
00360     <a class="code" href="md5_8c.html#a4">MD5STEP</a>(<a class="code" href="md5_8c.html#a3">F4</a>, b, c, d, a, in[9] + 0xeb86d391, 21);
00361 
00362     buf[0] += a;
00363     buf[1] += b;
00364     buf[2] += c;
00365     buf[3] += d;
00366 }
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat Jan 15 16:52:30 2005 for luau by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
